<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Коан 12 TOBIT, HECKIT | Розеттский камень</title>
  <meta name="description" content="Сборник коанов для эконометристов, жаждущих просветления." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Коан 12 TOBIT, HECKIT | Розеттский камень" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Сборник коанов для эконометристов, жаждущих просветления." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Коан 12 TOBIT, HECKIT | Розеттский камень" />
  
  <meta name="twitter:description" content="Сборник коанов для эконометристов, жаждущих просветления." />
  

<meta name="author" content="Пуассон, фея и три мексиканских негодяя" />


<meta name="date" content="2019-09-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dinpanel.html"/>
<link rel="next" href="treatment.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Напутственное слово</a></li>
<li class="chapter" data-level="2" data-path="installsoft.html"><a href="installsoft.html"><i class="fa fa-check"></i><b>2</b> Коан об установке софта</a></li>
<li class="chapter" data-level="3" data-path="simplereg.html"><a href="simplereg.html"><i class="fa fa-check"></i><b>3</b> Коан о простой линейной регрессии</a><ul>
<li class="chapter" data-level="3.1" data-path="simplereg.html"><a href="simplereg.html#r"><i class="fa fa-check"></i><b>3.1</b> r</a></li>
<li class="chapter" data-level="3.2" data-path="simplereg.html"><a href="simplereg.html#python"><i class="fa fa-check"></i><b>3.2</b> python</a></li>
<li class="chapter" data-level="3.3" data-path="simplereg.html"><a href="simplereg.html#stata"><i class="fa fa-check"></i><b>3.3</b> stata</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="poisreg.html"><a href="poisreg.html"><i class="fa fa-check"></i><b>4</b> Модели счетных данных</a><ul>
<li class="chapter" data-level="4.1" data-path="poisreg.html"><a href="poisreg.html#r-1"><i class="fa fa-check"></i><b>4.1</b> r</a></li>
<li class="chapter" data-level="4.2" data-path="poisreg.html"><a href="poisreg.html#python-1"><i class="fa fa-check"></i><b>4.2</b> python</a></li>
<li class="chapter" data-level="4.3" data-path="poisreg.html"><a href="poisreg.html#stata-1"><i class="fa fa-check"></i><b>4.3</b> stata</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="disordered.html"><a href="disordered.html"><i class="fa fa-check"></i><b>5</b> Модели неупорядоченного выбора</a></li>
<li class="chapter" data-level="6" data-path="instruments.html"><a href="instruments.html"><i class="fa fa-check"></i><b>6</b> Интcтрументы для простой регрессии</a></li>
<li class="chapter" data-level="7" data-path="arma.html"><a href="arma.html"><i class="fa fa-check"></i><b>7</b> ARMA</a><ul>
<li class="chapter" data-level="7.1" data-path="arma.html"><a href="arma.html#r-2"><i class="fa fa-check"></i><b>7.1</b> r</a></li>
<li class="chapter" data-level="7.2" data-path="arma.html"><a href="arma.html#python-2"><i class="fa fa-check"></i><b>7.2</b> python</a></li>
<li class="chapter" data-level="7.3" data-path="arma.html"><a href="arma.html#stata-2"><i class="fa fa-check"></i><b>7.3</b> stata</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="paneldata.html"><a href="paneldata.html"><i class="fa fa-check"></i><b>8</b> Панельные данные</a></li>
<li class="chapter" data-level="9" data-path="heterosked.html"><a href="heterosked.html"><i class="fa fa-check"></i><b>9</b> Гетероскедастичность в простой регрессии</a><ul>
<li class="chapter" data-level="9.1" data-path="heterosked.html"><a href="heterosked.html#r-3"><i class="fa fa-check"></i><b>9.1</b> r</a></li>
<li class="chapter" data-level="9.2" data-path="heterosked.html"><a href="heterosked.html#python-3"><i class="fa fa-check"></i><b>9.2</b> python</a></li>
<li class="chapter" data-level="9.3" data-path="heterosked.html"><a href="heterosked.html#stata-3"><i class="fa fa-check"></i><b>9.3</b> stata</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>10</b> PCA</a></li>
<li class="chapter" data-level="11" data-path="dinpanel.html"><a href="dinpanel.html"><i class="fa fa-check"></i><b>11</b> Динамические панели</a></li>
<li class="chapter" data-level="12" data-path="tobit-heckit.html"><a href="tobit-heckit.html"><i class="fa fa-check"></i><b>12</b> TOBIT, HECKIT</a></li>
<li class="chapter" data-level="13" data-path="treatment.html"><a href="treatment.html"><i class="fa fa-check"></i><b>13</b> Treatment effect</a></li>
<li class="chapter" data-level="14" data-path="compatability.html"><a href="compatability.html"><i class="fa fa-check"></i><b>14</b> Что-то там про совместимость и языки</a></li>
<li class="chapter" data-level="15" data-path="dict.html"><a href="dict.html"><i class="fa fa-check"></i><b>15</b> Словарь</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Розеттский камень</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tobit_heckit" class="section level1">
<h1><span class="header-section-number">Коан 12</span> TOBIT, HECKIT</h1>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb623-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb623-2" data-line-number="2"><span class="kw">library</span>(AER) <span class="co">#tobit</span></a>
<a class="sourceLine" id="cb623-3" data-line-number="3"><span class="kw">library</span>(sampleSelection) <span class="co">#heckit</span></a>
<a class="sourceLine" id="cb623-4" data-line-number="4"><span class="kw">library</span>(<span class="st">&#39;ltm&#39;</span>) <span class="co">#margins</span></a>
<a class="sourceLine" id="cb623-5" data-line-number="5"><span class="kw">library</span>(<span class="st">&#39;foreign&#39;</span>)</a>
<a class="sourceLine" id="cb623-6" data-line-number="6"><span class="kw">library</span>(skimr)</a></code></pre></div>
<p>Данная глава посвящена моделям с цензурированными выборками. В таких выборках часть значений целевой переменной будет дискретной переменной, а часть - непрерывной. Простой пример, который указывается в некоторых учебниках, это исследование расходов семей на автомобили. Каждая семья может либо потратить какую-то сумму на автомобиль, либо, если она не может позволить себе автомобиль, то значение расходов будет равно нулю. Соответственно, переменная демонстрирует либо факт неучастия в покупке автомобиля, либо степень участия в виде суммы. Оценивается в данном случае обычная регрессионная модель, но с функцией правдоподобия следующего вида:</p>
<p><span class="math display">\[\begin{equation}
L=\prod_{y_{t}=0}\left(1-\Phi\left(\frac{\boldsymbol{x}_{t}^{\prime} \boldsymbol{\beta}}{\sigma}\right)\right) \prod_{y_{t}&gt;0} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(-\frac{1}{2 \sigma^{2}}\left(y_{t}-\boldsymbol{x}_{t}^{\prime} \boldsymbol{\beta}\right)^{2}\right)
\end{equation}\]</span></p>
<p>Для начала подгрузим данные и визуализируем их. Этот датасет результаты тестирования двухсот школьников по шкале от 200 до 800 (apt), а также их успеваемость по чтению и математике (read и math соответственно). Построим гистограмму, наложив поверх неё функцию плотности нормального распределения.</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" data-line-number="1">data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;tobit.csv&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb625-1" data-line-number="1"><span class="co"># Функция, генерирующая функцию плотности нормального распределения в соответствии с распределением вектора входных данных</span></a>
<a class="sourceLine" id="cb625-2" data-line-number="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(x, var, <span class="dt">bw =</span> <span class="dv">15</span>) {</a>
<a class="sourceLine" id="cb625-3" data-line-number="3">  <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="kw">mean</span>(var), <span class="kw">sd</span>(var)) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(var)  <span class="op">*</span><span class="st"> </span>bw</a>
<a class="sourceLine" id="cb625-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb625-5" data-line-number="5"></a>
<a class="sourceLine" id="cb625-6" data-line-number="6"></a>
<a class="sourceLine" id="cb625-7" data-line-number="7">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> apt, <span class="dt">fill=</span>prog))</a>
<a class="sourceLine" id="cb625-8" data-line-number="8">p <span class="op">+</span><span class="st"> </span><span class="kw">stat_bin</span>(<span class="dt">binwidth=</span><span class="dv">15</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb625-9" data-line-number="9"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> f, <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb625-10" data-line-number="10">    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">var =</span> data<span class="op">$</span>apt))</a></code></pre></div>
<p><img src="13-tobit_heckit_files/figure-html/hist%20plot%20chunk-1.png" width="672" /></p>
<p>Как можем видеть, нашлось довольно много школьников, которые написали тест на высший балл. В связи с этим распределение даллеко от нормального из-за ограничений баллов теста. Вид выборки также довольно специфичен при взгляде на диаграмму рассеяния. Довольно различимая линейная зависимость как бы сплюснута сверху.</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb626-1" data-line-number="1">g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(math, apt, <span class="dt">col =</span> prog))</a>
<a class="sourceLine" id="cb626-2" data-line-number="2">g <span class="op">+</span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="13-tobit_heckit_files/figure-html/scatter%20plot%20chunk-1.png" width="672" /></p>
<p>Оценим Тобит-модель:</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb627-1" data-line-number="1">model_tobit =<span class="st"> </span><span class="kw">tobit</span>(apt <span class="op">~</span><span class="st"> </span>math <span class="op">+</span><span class="st"> </span>read, <span class="dt">data =</span> data, <span class="dt">right =</span> <span class="dv">800</span>)</a>
<a class="sourceLine" id="cb627-2" data-line-number="2"><span class="kw">summary</span>(model_tobit)</a></code></pre></div>
<pre><code>
Call:
tobit(formula = apt ~ math + read, right = 800, data = data)

Observations:
         Total  Left-censored     Uncensored Right-censored 
           200              0            183             17 

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 159.00366   29.90374   5.317 1.05e-07 ***
math          6.34441    0.70306   9.024  &lt; 2e-16 ***
read          2.88961    0.63295   4.565 4.99e-06 ***
Log(scale)    4.21923    0.05293  79.719  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Scale: 67.98 

Gaussian distribution
Number of Newton-Raphson Iterations: 5 
Log-likelihood: -1047 on 4 Df
Wald-statistic: 266.2 on 2 Df, p-value: &lt; 2.22e-16 </code></pre>
<p>Модель Тобина имеет ряд ограничений. Основное из них – это зависимость вероятности участия и интенсивности участия определяется одним и тем же набором переменных. Для преодоления этих ограничений была предложена модель Хекмана. В ней принятие решения “участвовать - не участвовать” и определение степени участия могут зависеть от разных переменных.</p>
<p>Загрузим другие данные во славу разнообразия.</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb629-1" data-line-number="1">data =<span class="st"> </span><span class="kw">read.dta</span>(<span class="st">&#39;data_alcohol&amp;tobacco.dta&#39;</span>)</a>
<a class="sourceLine" id="cb629-2" data-line-number="2"><span class="kw">summary</span>(data)</a></code></pre></div>
<pre><code>     obs                 age           bluecol            lnx       
 Length:2724        Min.   :0.000   Min.   :0.0000   Min.   :11.76  
 Class :character   1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:13.41  
 Mode  :character   Median :2.000   Median :0.0000   Median :13.76  
                    Mean   :2.408   Mean   :0.1468   Mean   :13.73  
                    3rd Qu.:4.000   3rd Qu.:0.0000   3rd Qu.:14.06  
                    Max.   :4.000   Max.   :1.0000   Max.   :15.33  
    flanders         nadults        ninfants           nkids       
 Min.   :0.0000   Min.   :1.00   Min.   :0.00000   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:1.00   1st Qu.:0.00000   1st Qu.:0.0000  
 Median :0.0000   Median :2.00   Median :0.00000   Median :0.0000  
 Mean   :0.4519   Mean   :1.97   Mean   :0.04479   Mean   :0.5646  
 3rd Qu.:1.0000   3rd Qu.:2.00   3rd Qu.:0.00000   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :7.00   Max.   :2.00000   Max.   :5.0000  
     resid                shalc              shtob        
 Min.   :-0.9797682   Min.   :0.000000   Min.   :0.00000  
 1st Qu.: 0.0626030   1st Qu.:0.002906   1st Qu.:0.00000  
 Median : 0.1223031   Median :0.010898   Median :0.00000  
 Mean   : 0.0001171   Mean   :0.017828   Mean   :0.01224  
 3rd Qu.: 0.1854353   3rd Qu.:0.024244   3rd Qu.:0.01381  
 Max.   : 0.5795787   Max.   :0.211124   Max.   :0.19276  
    walloon          whitecol      shalc_tobit             alc        
 Min.   :0.0000   Min.   :0.000   Min.   :-0.005627   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:0.000   1st Qu.: 0.010925   1st Qu.:1.0000  
 Median :0.0000   Median :0.000   Median : 0.015169   Median :1.0000  
 Mean   :0.3814   Mean   :0.333   Mean   : 0.015198   Mean   :0.8289  
 3rd Qu.:1.0000   3rd Qu.:1.000   3rd Qu.: 0.019735   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :1.000   Max.   : 0.032814   Max.   :1.0000  
      tob        
 Min.   :0.0000  
 1st Qu.:0.0000  
 Median :0.0000  
 Mean   :0.3803  
 3rd Qu.:1.0000  
 Max.   :1.0000  </code></pre>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb631-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(x, var, <span class="dt">bw =</span> <span class="dv">15</span>) {</a>
<a class="sourceLine" id="cb631-2" data-line-number="2">  <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="kw">mean</span>(var), <span class="kw">sd</span>(var)) <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(var)  <span class="op">*</span><span class="st"> </span>bw</a>
<a class="sourceLine" id="cb631-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb631-4" data-line-number="4"></a>
<a class="sourceLine" id="cb631-5" data-line-number="5"></a>
<a class="sourceLine" id="cb631-6" data-line-number="6">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> shalc))</a>
<a class="sourceLine" id="cb631-7" data-line-number="7">p <span class="op">+</span><span class="st"> </span><span class="kw">stat_bin</span>(<span class="dt">binwidth=</span><span class="fl">0.01</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb631-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> f, <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb631-9" data-line-number="9">    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">var =</span> data<span class="op">$</span>alc))</a></code></pre></div>
<p><img src="13-tobit_heckit_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb632-1" data-line-number="1">heck1 =<span class="st"> </span><span class="kw">heckit</span>(alc <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>nadults <span class="op">+</span><span class="st"> </span>nkids <span class="op">+</span><span class="st"> </span>lnx <span class="op">+</span><span class="st"> </span>walloon, shalc <span class="op">~</span><span class="st">  </span>age <span class="op">+</span><span class="st"> </span>nadults <span class="op">+</span><span class="st"> </span>nkids <span class="op">+</span><span class="st"> </span>lnx <span class="op">+</span><span class="st"> </span>walloon, <span class="dt">data =</span> data, <span class="dt">method =</span> <span class="st">&#39;ml&#39;</span>)</a>
<a class="sourceLine" id="cb632-2" data-line-number="2"><span class="kw">summary</span>(heck1)</a></code></pre></div>
<pre><code>--------------------------------------------
Tobit 2 model (sample selection model)
Maximum Likelihood estimation
Newton-Raphson maximisation, 5 iterations
Return code 2: successive function values within tolerance limit
Log-Likelihood: 4311.465 
2724 observations (466 censored and 2258 observed)
14 free parameters (df = 2710)
Probit selection equation:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -11.12847    0.99823 -11.148  &lt; 2e-16 ***
age           0.06449    0.02333   2.765  0.00574 ** 
nadults      -0.08657    0.04198  -2.062  0.03927 *  
nkids        -0.08477    0.03621  -2.341  0.01929 *  
lnx           0.88399    0.07585  11.654  &lt; 2e-16 ***
walloon       0.19751    0.06229   3.171  0.00154 ** 
Outcome equation:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.0413302  0.0205897   2.007 0.044815 *  
age          0.0022075  0.0003854   5.727 1.13e-08 ***
nadults     -0.0017463  0.0006455  -2.705 0.006865 ** 
nkids       -0.0021381  0.0005640  -3.791 0.000153 ***
lnx         -0.0015570  0.0014823  -1.050 0.293642    
walloon      0.0025647  0.0009575   2.679 0.007437 ** 
   Error terms:
        Estimate Std. Error t value Pr(&gt;|t|)    
sigma  0.0214606  0.0003194  67.187   &lt;2e-16 ***
rho   -0.0062437  0.1345571  -0.046    0.963    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
--------------------------------------------</code></pre>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb634-1" data-line-number="1">heck2 =<span class="st"> </span><span class="kw">heckit2fit</span>(alc <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>nadults <span class="op">+</span><span class="st"> </span>nkids <span class="op">+</span><span class="st"> </span>lnx <span class="op">+</span><span class="st"> </span>walloon, shalc <span class="op">~</span><span class="st">  </span>age <span class="op">+</span><span class="st"> </span>nadults <span class="op">+</span><span class="st"> </span>nkids <span class="op">+</span><span class="st"> </span>lnx <span class="op">+</span><span class="st"> </span>walloon, <span class="dt">data =</span> data)</a>
<a class="sourceLine" id="cb634-2" data-line-number="2"><span class="kw">summary</span>(heck2)</a></code></pre></div>
<pre><code>--------------------------------------------
Tobit 2 model (sample selection model)
2-step Heckman / heckit estimation
2724 observations (466 censored and 2258 observed)
15 free parameters (df = 2710)
Probit selection equation:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -11.12810    0.99819 -11.148  &lt; 2e-16 ***
age           0.06448    0.02332   2.765  0.00574 ** 
nadults      -0.08653    0.04196  -2.062  0.03930 *  
nkids        -0.08475    0.03620  -2.341  0.01931 *  
lnx           0.88396    0.07585  11.654  &lt; 2e-16 ***
walloon       0.19748    0.06228   3.171  0.00154 ** 
Outcome equation:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.0584579  0.0763935   0.765 0.444207    
age          0.0021170  0.0005482   3.862 0.000115 ***
nadults     -0.0016402  0.0007920  -2.071 0.038456 *  
nkids       -0.0020387  0.0007089  -2.876 0.004062 ** 
lnx         -0.0027209  0.0052148  -0.522 0.601873    
walloon      0.0023175  0.0014319   1.619 0.105666    
Multiple R-Squared:0.0534,  Adjusted R-Squared:0.0509
   Error terms:
               Estimate Std. Error t value Pr(&gt;|t|)
invMillsRatio -0.003805   0.016022  -0.237    0.812
sigma          0.021579         NA      NA       NA
rho           -0.176330         NA      NA       NA
--------------------------------------------</code></pre>
<p>Теперь то же самое в STATA.</p>
<pre class="stata"><code>clear
use tobit
summarize</code></pre>
<pre><code>    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
          v1 |        200        99.5    57.87918          0        199
    unnamed0 |        200        99.5    57.87918          0        199
          id |        200       100.5    57.87918          1        200
        read |        200       52.23    10.25294         28         76
        math |        200      52.645    9.368448         33         75
-------------+---------------------------------------------------------
        prog |          0
         apt |        200     640.035    99.21903        352        800
         top |        200        .915    .2795815          0          1</code></pre>
<pre class="stata"><code>egen prog_2 = group(prog)
tobit apt read math i.prog_2, ul</code></pre>
<pre><code>Tobit regression                                Number of obs     =        200
                                                LR chi2(4)        =     188.97
                                                Prob &gt; chi2       =     0.0000
Log likelihood = -1041.0629                     Pseudo R2         =     0.0832

------------------------------------------------------------------------------
         apt |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        read |   2.697939    .618798     4.36   0.000     1.477582    3.918296
        math |   5.914485   .7098063     8.33   0.000     4.514647    7.314323
             |
      prog_2 |
          2  |  -12.71476   12.40629    -1.02   0.307    -37.18173     11.7522
          3  |   -46.1439   13.72401    -3.36   0.001     -73.2096   -19.07821
             |
       _cons |    209.566   32.77154     6.39   0.000     144.9359    274.1961
-------------+----------------------------------------------------------------
      /sigma |   65.67672   3.481272                      58.81116    72.54228
------------------------------------------------------------------------------
             0  left-censored observations
           183     uncensored observations
            17 right-censored observations at apt &gt;= 800</code></pre>
<pre class="stata"><code>clear all
use data_alcohol&amp;tobacco
heckman shalc age nadults nkids lnx walloon, select(alc = age nadults nkids lnx walloon)
</code></pre>
<pre><code>Iteration 0:   log likelihood =  4309.5307  
Iteration 1:   log likelihood =  4311.3949  
Iteration 2:   log likelihood =  4311.4638  
Iteration 3:   log likelihood =  4311.4649  
Iteration 4:   log likelihood =  4311.4649  

Heckman selection model                         Number of obs     =      2,724
(regression model with sample selection)        Censored obs      =        466
                                                Uncensored obs    =      2,258

                                                Wald chi2(5)      =     126.74
Log likelihood =  4311.465                      Prob &gt; chi2       =     0.0000

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
shalc        |
         age |   .0022075   .0003854     5.73   0.000     .0014521     .002963
     nadults |  -.0017463   .0006455    -2.71   0.007    -.0030114   -.0004812
       nkids |  -.0021381    .000564    -3.79   0.000    -.0032435   -.0010327
         lnx |   -.001557   .0014823    -1.05   0.294    -.0044622    .0013483
     walloon |   .0025647   .0009575     2.68   0.007     .0006881    .0044413
       _cons |   .0413301   .0205898     2.01   0.045     .0009749    .0816853
-------------+----------------------------------------------------------------
alc          |
         age |    .064492   .0233269     2.76   0.006     .0187722    .1102118
     nadults |  -.0865676   .0419754    -2.06   0.039    -.1688379   -.0042973
       nkids |  -.0847672   .0362055    -2.34   0.019    -.1557287   -.0138058
         lnx |   .8839885   .0758532    11.65   0.000      .735319    1.032658
     walloon |   .1975137    .062286     3.17   0.002     .0754353    .3195921
       _cons |  -11.12847   .9982321   -11.15   0.000    -13.08497   -9.171975
-------------+----------------------------------------------------------------
     /athrho |  -.0062433   .1345632    -0.05   0.963    -.2699823    .2574956
    /lnsigma |  -3.841538   .0148838  -258.10   0.000    -3.870709   -3.812366
-------------+----------------------------------------------------------------
         rho |  -.0062433   .1345579                     -.2636083    .2519516
       sigma |   .0214606   .0003194                      .0208436    .0220958
      lambda |   -.000134   .0028877                     -.0057938    .0055259
------------------------------------------------------------------------------
LR test of indep. eqns. (rho = 0):   chi2(1) =     0.00   Prob &gt; chi2 = 0.9640</code></pre>
<pre class="stata"><code>heckman shalc age nadults nkids lnx walloon, select(alc = age nadults nkids lnx walloon) twostep</code></pre>
<pre><code>&gt; nx walloon) twostep

Heckman selection model -- two-step estimates   Number of obs     =      2,724
(regression model with sample selection)        Censored obs      =        466
                                                Uncensored obs    =      2,258

                                                Wald chi2(5)      =     125.15
                                                Prob &gt; chi2       =     0.0000

------------------------------------------------------------------------------
             |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
shalc        |
         age |    .002117   .0005482     3.86   0.000     .0010426    .0031915
     nadults |  -.0016402    .000792    -2.07   0.038    -.0031925   -.0000879
       nkids |  -.0020387   .0007089    -2.88   0.004    -.0034282   -.0006492
         lnx |  -.0027209   .0052148    -0.52   0.602    -.0129417    .0074998
     walloon |   .0023175   .0014319     1.62   0.106    -.0004889     .005124
       _cons |   .0584579   .0763935     0.77   0.444    -.0912706    .2081865
-------------+----------------------------------------------------------------
alc          |
         age |    .064482   .0233247     2.76   0.006     .0187665    .1101975
     nadults |  -.0865298   .0419629    -2.06   0.039    -.1687756   -.0042839
       nkids |  -.0847535   .0362048    -2.34   0.019    -.1557135   -.0137934
         lnx |   .8839584   .0758491    11.65   0.000     .7352969     1.03262
     walloon |   .1974812   .0622813     3.17   0.002     .0754121    .3195503
       _cons |   -11.1281   .9981866   -11.15   0.000    -13.08451   -9.171695
-------------+----------------------------------------------------------------
mills        |
      lambda |   -.003805    .016022    -0.24   0.812    -.0352075    .0275975
-------------+----------------------------------------------------------------
         rho |   -0.17633
       sigma |  .02157888
------------------------------------------------------------------------------</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="dinpanel.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="treatment.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Rosetta_Stone.pdf", "Rosetta_Stone.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
